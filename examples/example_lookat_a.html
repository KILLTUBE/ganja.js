<script type="module">
import Algebra from "../ganja.js"; // enki's version + export default Algebra
//import Algebra from "../src/index.js"; // kungfooman's version
Algebra(3,0,1,()=>{
  const point = (x,y)=>!(1e0 + x*1e1 + y*1e2);

  var A = point(-1,-0.4);
  var B = point( 1, 0.4);
    
  var align = (p,q)=>{
    for (var i=0, M=1, P=!1, Q=!1; i<p.length; ++i) {
      P = Q & (M >>> p[i]);
      Q = Q & q[i];
      M = (1 + Q.Normalized / P.Normalized).Normalized * M;
    }
    return M
  }

  var lerp = (m,t)=>((1 - t) + t * m).Normalized;

  var path = (m, steps, x)=>[...Array(steps)].map((e,i)=>lerp(m,i/(steps-1)) >>> x);

  var svg = this.graph(()=>{
    var t = 0.5 + 0.5 * Math.sin(performance.now()/1000);
    return [
      0xFF0000, ...path(align([A],[B]),10,A),
      0x224488, A, "A", B, "B",
    ]
  },{
    grid:1,
    scale:1.5,
    fontSize:2,
    pointRadius:2,
  });

  svg.style.width = '600px';
  svg.style.height = '400px';
  svg.style.background = 'white';

  document.body.appendChild(svg);
});
</script>
